function dkb_chat_drag(a,b){function j(b){var d,e,f,g,j;if(c)return d=b||window.event,e=d.clientX-h,f=d.clientY-i,g=document.documentElement.clientWidth-a.offsetWidth,j=document.documentElement.clientHeight-a.offsetHeight,e=0>e?0:e,e=e>g?g:e,f=0>f?0:f,f=f>j?j:f,a.style.left=e+"px",a.style.top=f+"px",b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,!1}function k(b){dkb_chat_lib.$("dkb_chat_overlay").style.display="none",c=!1,a.releaseCapture&&a.releaseCapture(),b||(b=window.event),document.removeEventListener?(document.removeEventListener("mouseup",k,!0),document.removeEventListener("mousemove",j,!0)):(a.detachEvent("onlosecapture",k),a.detachEvent("onmouseup",k),a.detachEvent("onmousemove",j)),b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}var c,d,e,f,g,h,i;b=b||window.event,dkb_chat_browser.ieVersion||(dkb_chat_lib.$("dkb_chat_overlay").style.display="block"),c=!0,d=b.clientX,e=b.clientY,f=a.offsetLeft,g=a.offsetTop,h=d-f,i=e-g,document.addEventListener?(document.addEventListener("mousemove",j,!0),document.addEventListener("mouseup",k,!0)):(a.attachEvent("onmousemove",j),a.attachEvent("onmouseup",k),a.attachEvent("onlosecapture",k)),document.onmouseup=window.onblur=k,a.setCapture&&a.setCapture(),b.preventDefault?b.preventDefault():b.returnValue=!1}function dkb_XReceive(a){a&&("tscroll"==a.m?dkb_chat_layout.startScroll():"close"==a.m&&(dkb_chat_layout.hideMChat(),dkb_chat_layout.clearIframeSrc()))}var dkb_chat_lib,dkb_chat_layout,dkb_chat_browser={};dkb_chat_browser.ieVersion=/msie (\d+)/.exec(navigator.userAgent.toLowerCase()),dkb_chat_browser.higherThanIE6=dkb_chat_browser.ieVersion&&parseInt(dkb_chat_browser.ieVersion[1])>6,dkb_chat_browser.higherThanIE8=dkb_chat_browser.ieVersion&&parseInt(dkb_chat_browser.ieVersion[1])>8,dkb_chat_browser.onQuirkMode=document.compatMode&&0==document.compatMode.indexOf("Back"),dkb_chat_browser.ieVersion&&!dkb_chat_browser.higherThanIE6&&document.execCommand("BackgroundImageCache",!1,!0),dkb_chat_lib={$:function(a){return document.getElementById(a)}},dkb_chat_layout={dTitle:document.title,scrollTimer:0,scrollFlag:!0,scrollTmp:"",scrollTip:DKB_CHAT_MSGTIP,scrollTitle:function(){1==this.scrollFlag?(this.scrollFlag=!1,this.scrollTmp=".........."):(this.scrollFlag=!0,this.scrollTmp=this.scrollTip),document.title=this.scrollTmp},resetTitle:function(){this.scrollTimer>0&&(clearInterval(this.scrollTimer),this.scrollTimer=0),this.scrollFlag=!0,document.title=this.dTitle},startScroll:function(){0==this.scrollTimer&&window.is_dkb_chat_loaded&&window.is_dkb_chat_show&&(this.scrollTimer=setInterval("dkb_chat_layout.scrollTitle()",300),setTimeout("dkb_chat_layout.resetTitle()",8e3))},getModule:function(){return"undefined"==typeof dkb_chat_layout_mod?"":dkb_chat_layout_mod.join("")},createLayout:function(){document.write(this.getModule().replace(/\$\{[.\w]+\}/g,this.__layoutVarReplacer)),this.mcWrap=dkb_chat_lib.$(DKB_CHAT_WRAP_ID)},__layoutVarReplacer:function(str){if(0==str.indexOf("$"))try{return eval(str.substr(2,str.length-3))}catch(e){return""}return str},bindEvent:function(a,b){window.attachEvent?window.attachEvent("on"+a,b):window.addEventListener(a,b,!1)},initStyle:function(){if(null==this.mcWrap&&(this.mcWrap=dkb_chat_lib.$(DKB_CHAT_WRAP_ID)),null!=this.mcWrap)if(window.addEventListener||dkb_chat_browser.higherThanIE6&&!dkb_chat_browser.onQuirkMode){if(0==DKB_CHAT_POS||4==DKB_CHAT_POS?this.mcWrap.style.right=DKB_CHAT_POS_SIDEMARGIN+"px":(1==DKB_CHAT_POS||3==DKB_CHAT_POS)&&(this.mcWrap.style.left=DKB_CHAT_POS_SIDEMARGIN+"px"),0==DKB_CHAT_POS||1==DKB_CHAT_POS)this.mcWrap.style.top="",this.mcWrap.style.bottom="0px";else{if(3!=DKB_CHAT_POS&&4!=DKB_CHAT_POS)return;this.mcWrap.style.top=parseInt(DKB_CHAT_POS_TOPMARGIN)+"px",this.mcWrap.style.bottom=""}this.mcWrap.style.position="fixed"}else this.bindEvent("scroll",this.fixMChatPosition),this.bindEvent("resize",this.fixMChatPosition),this.fixMChatPosition()},fixMChatPosition:function(){var a=dkb_chat_layout,b=dkb_chat_browser.onQuirkMode?document.body:document.documentElement;if(0==DKB_CHAT_POS||4==DKB_CHAT_POS?a.mcWrap.style.right=DKB_CHAT_POS_SIDEMARGIN+"px":(1==DKB_CHAT_POS||3==DKB_CHAT_POS)&&(a.mcWrap.style.left=DKB_CHAT_POS_SIDEMARGIN+"px"),0==DKB_CHAT_POS||1==DKB_CHAT_POS)a.mcWrap.style.top=parseInt(b.clientHeight)+parseInt(b.scrollTop)-a.mcWrap.offsetHeight+"px";else{if(3!=DKB_CHAT_POS&&4!=DKB_CHAT_POS)return;a.mcWrap.style.top=parseInt(b.scrollTop)+parseInt(DKB_CHAT_POS_TOPMARGIN)+"px"}},showMChat:function(a){var d,c=dkb_chat_layout;window.is_dkb_chat_loaded&&!window.is_dkb_chat_show&&(window.is_dkb_chat_show=!0,this.mcWrap=dkb_chat_lib.$(DKB_CHAT_WRAP_ID),d=String.format(DKB_CHAT_TMP,a),dkb_chat_lib.$(DKB_CHAT_WRAP_ID).innerHTML=d,this.mcWrap.style.display="block",!window.attachEvent||dkb_chat_browser.higherThanIE6&&!dkb_chat_browser.onQuirkMode||window.opera||c.fixMChatPosition())},hideMChat:function(){window.is_dkb_chat_loaded&&window.is_dkb_chat_show&&(this.mcWrap.style.display="none",window.is_dkb_chat_show=!1,this.XSend({m:"stop"}))},clearIframeSrc:function(){var a=dkb_chat_lib.$(DKB_CHAT_IF_ID);a.src=""},createMChat:function(){window.is_dkb_chat_loaded||(window.is_dkb_chat_loaded=!0,dkb_chat_layout.createLayout(),setTimeout(function(){dkb_chat_layout.initStyle()},10))},isShow:function(){return window.is_dkb_chat_show},XSend:function(a){XDomain&&XDomain.sendMessage(dkb_chat_lib.$(DKB_CHAT_IF_ID).contentWindow,a)},endChat:function(){this.hideMChat(),this.XSend({m:"end"})}},dkb_chat_layout.createMChat(),document.write('<script type="text/javascript" src="'+DKB_CHAT_XDPATH+'"></script>');